# Maintainer: Jacob Hrbek <kreyren@fsfe.org>
# Contributor: Milan P. StaniÄ‡ <mps@arvanta.net>

# FIXME(Krey): Implement EFI

# FIXME(Krey): Get rid of these two prior to merge
# shellcheck disable=SC2154 # pre-defined variables
: "$srcdir" "$pkgdir" "$startdir"

# shellcheck disable=SC2034 # builtin variables
: "$pkgdesc" "$pkgname" "$pkgver" "$pkgrel" "$arch" "$url" "$license" "$depends" "$makedepends" "$source" "$options" "$sha512sums"

pkgdesc="OLIMEX Teres-I"
pkgname="device-olimex-teres_i"
pkgver=1.0
pkgrel=0

arch="aarch64"
url="https://wiki.postmarketos.org/wiki/OLIMEX_Teres_i"
license="MIT"

# FIXME(Krey): the rtl8723bs linux driver should be enough for wifi and BLE, figure out why that doesn't work without the `linux-firmware-rtlwifi` else move to nonfree firmware subpackage (https://gitlab.com/postmarketOS/pmaports/-/merge_requests/4743#note_1734077436)
# FIXME(Krey): mesa-egl might not be needed
depends="
	linux-postmarketos-allwinner>=5.14
	mesa-egl
	postmarketos-base
	linux-firmware-rtlwifi
	u-boot-sunxi>=2024.01-2
	"
makedepends="devicepkg-dev"

source="deviceinfo"

options="!check" # We don't have any tests to run

build() {
	devicepkg_build "$startdir" "$pkgname"
}

package() {
	devicepkg_package "$startdir" $pkgname
}

sha512sums="
64ec120463f155a7f912e8ce09c344eaf9b231d195df488a6a6dae0f7cd5ea101c27e7ae45a0653018565194f55ea62ac769a4f75c9683f3a67937eb69a6102c  deviceinfo
"
