# Maintainer: Jacob Hrbek <kreyren@fsfe.org>

# Credit: Milan P. StaniÄ‡ for maintaining the device on Alpine Linux including u-boot, arm-trusted-firmware, crust and finding a solution to broken display when compiled on alpine.

# FIXME(Krey): Implement EFI

# shellcheck disable=SC2154 # pre-defined values
: "$srcdir" "$pkgdir" "$startdir"

pkgdesc="OLIMEX Teres-I"
pkgname="device-olimex-teres_i"
pkgver=1.0
pkgrel=0

arch="aarch64"
url="https://wiki.postmarketos.org/wiki/OLIMEX_Teres_i"
license="EUPL"

# FIXME(Krey): the rtl8723bs linux driver should be enough for wifi and BLE, figure out why that doesn't work without the `linux-firmware-rtlwifi`
depends="
	linux-postmarketos-allwinner>=5.14
	mesa-egl
	postmarketos-base
	linux-firmware-rtlwifi
	u-boot-sunxi
	"
makedepends="devicepkg-dev"

source="./deviceinfo"

options="!check" # We don't have any tests to run

build() {
	devicepkg_build "$startdir" "$pkgname"
}

package() {
	devicepkg_package "$startdir" $pkgname
}

sha512sums="
15ef26ba5eb8eff9d81921b96778eec8870f41156f62caa296575e5c01ce2f18342bee410b370a12ca52ea9eb4ecded50dac30945f3e9bd3407135a3d458d43c  deviceinfo
"
